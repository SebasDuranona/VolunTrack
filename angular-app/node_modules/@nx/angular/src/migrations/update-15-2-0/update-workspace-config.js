"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const devkit_1 = require("@nx/devkit");
const workspace_models_1 = require("@schematics/angular/utility/workspace-models");
async function updateWorkspaceConfigurations(tree) {
    const projects = (0, devkit_1.getProjects)(tree);
    const supportedExecutors = new Set([workspace_models_1.Builders.Server]);
    for (const [name, project] of projects) {
        for (const [targetName, target] of Object.entries(project.targets || {})) {
            if (!supportedExecutors.has(target.executor)) {
                continue;
            }
            target.options.bundleDependencies = undefined;
            for (const [configurationName, configuration] of Object.entries(target.configurations || {})) {
                configuration.bundleDependencies = undefined;
                target[configurationName] = configuration;
            }
            project.targets[targetName] = target;
            (0, devkit_1.updateProjectConfiguration)(tree, name, project);
        }
    }
    await (0, devkit_1.formatFiles)(tree);
}
exports.default = updateWorkspaceConfigurations;
