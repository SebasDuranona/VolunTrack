"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.updateEditorTsConfig = void 0;
const devkit_1 = require("@nx/devkit");
const update_app_editor_tsconfig_excluded_files_1 = require("../../utils/update-app-editor-tsconfig-excluded-files");
function getCompilerOptionsTypes(tsConfig) {
    return tsConfig?.compilerOptions?.types ?? [];
}
function updateEditorTsConfig(tree, options) {
    const appTsConfig = (0, devkit_1.readJson)(tree, (0, devkit_1.joinPathFragments)(options.appProjectRoot, 'tsconfig.app.json'));
    const types = getCompilerOptionsTypes(appTsConfig);
    if (types?.length) {
        (0, devkit_1.updateJson)(tree, (0, devkit_1.joinPathFragments)(options.appProjectRoot, 'tsconfig.editor.json'), (json) => {
            json.compilerOptions ??= {};
            json.compilerOptions.types = Array.from(new Set(types));
            return json;
        });
    }
    const project = (0, devkit_1.readProjectConfiguration)(tree, options.name);
    (0, update_app_editor_tsconfig_excluded_files_1.updateAppEditorTsConfigExcludedFiles)(tree, project);
}
exports.updateEditorTsConfig = updateEditorTsConfig;
